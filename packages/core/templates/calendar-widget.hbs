{{!-- Calendar Widget Template --}}
<div class="calendar-widget-content">
  {{#if error}}
    <div class="error-state">
      <i class="fas fa-exclamation-triangle"></i>
      <span>{{error}}</span>
    </div>
  {{else}}
    {{!-- Calendar Header --}}
    <div class="calendar-header">
      <span class="calendar-name">{{calendar.label}}</span>
      <div class="header-controls">
        <button type="button" class="header-control-btn" data-action="switchToMini" data-tooltip="Switch to Mini Widget">
          <i class="fas fa-compress-alt"></i>
        </button>
        <button type="button" class="header-control-btn" data-action="switchToGrid" data-tooltip="Switch to Grid Widget">
          <i class="fas fa-th"></i>
        </button>
        {{#if isGM}}
        <button type="button" class="header-control-btn" data-action="openCalendarSelection" data-tooltip="Change Calendar System">
          <i class="fas fa-cog"></i>
        </button>
        {{/if}}
      </div>
    </div>

    {{!-- Date Display --}}
    <div class="date-display" data-action="openDetailedView" data-tooltip="Click for detailed view">
      <div class="main-date">{{shortDate}}</div>
      {{#if timeString}}
        <div class="time-display">
          <span class="time">{{timeString}}</span>
        </div>
      {{/if}}
      <div data-application-part="moonPhases"></div>
    </div>

    {{!-- Calendar Controls --}}
    {{#if canAdvanceTime}}
      <div class="calendar-controls">
        {{!-- Time Advancement Controls Section --}}
        <div class="time-advancement-section">
          <div class="control-group horizontal">
            <label>Time Advancement:</label>
            <div class="advancement-controls">
              <button data-action="toggleTimeAdvancement"
                      class="play-pause-btn {{#if timeAdvancementActive}}active{{/if}}"
                      data-tooltip="{{#if timeAdvancementActive}}Pause automatic time advancement ({{advancementRatioDisplay}}){{else}}Play automatic time advancement ({{advancementRatioDisplay}}){{/if}}">
                <i class="fas fa-{{#if timeAdvancementActive}}pause{{else}}play{{/if}}"></i>
                {{#if timeAdvancementActive}}Pause ({{advancementRatioDisplay}}){{else}}Play ({{advancementRatioDisplay}}){{/if}}
              </button>
            </div>
          </div>
        </div>
        
        {{!-- Existing time controls continue below --}}
        {{#if showTimeControls}}
          <div class="time-advance-section">
            <div class="control-group">
              <label>Quick Time:</label>
              <div class="time-buttons">
                {{#each (getQuickTimeButtons false)}}
                  <button data-action="advanceDate"
                          data-amount="{{this.amount}}"
                          data-unit="{{this.unit}}"
                          class="{{#if (lt this.amount 0)}}rewind{{/if}}"
                          data-tooltip="{{#if (lt this.amount 0)}}Go back{{else}}Advance{{/if}} {{this.label}}">
                    <i class="fas fa-{{#if (lt this.amount 0)}}backward{{else}}clock{{/if}}"></i> {{this.label}}
                  </button>
                {{/each}}
              </div>
            </div>
          </div>
        {{/if}}

        <div class="date-advance-section">
          <div class="control-group">
            <label>Date Controls:</label>
            <div class="date-buttons">
              <button data-action="advanceDate" data-amount="1" data-unit="days" data-tooltip="Advance 1 day">
                <i class="fas fa-plus"></i> 1 Day
              </button>
              <button data-action="advanceDate" data-amount="1" data-unit="weeks" data-tooltip="Advance 1 week">
                <i class="fas fa-plus"></i> 1 Week
              </button>
              <button data-action="advanceDate" data-amount="1" data-unit="months" data-tooltip="Advance 1 month">
                <i class="fas fa-plus"></i> 1 Month
              </button>
            </div>
            <div class="date-buttons">
              <button data-action="advanceDate" data-amount="-1" data-unit="days" class="rewind" data-tooltip="Go back 1 day">
                <i class="fas fa-minus"></i> 1 Day
              </button>
              <button data-action="advanceDate" data-amount="-1" data-unit="weeks" class="rewind" data-tooltip="Go back 1 week">
                <i class="fas fa-minus"></i> 1 Week
              </button>
              <button data-action="advanceDate" data-amount="-1" data-unit="months" class="rewind" data-tooltip="Go back 1 month">
                <i class="fas fa-minus"></i> 1 Month
              </button>
            </div>
          </div>
        </div>

      </div>
    {{/if}}

    {{!-- Additional Info --}}
    {{#if calendar.description}}
      <div class="calendar-description" data-tooltip="{{calendar.description}}">
        <i class="fas fa-info-circle"></i>
        <span>{{calendar.description}}</span>
      </div>
    {{/if}}
  {{/if}}
</div>
